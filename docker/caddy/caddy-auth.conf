# Fail2ban filter for Caddy authentication failures
# This file should be placed in /docker/appdata/fail2ban-caddy/data/filter.d/caddy-auth.conf

[Definition]

# Matches authentication failures in Caddy JSON logs
failregex = ^.*"remote_ip":"<HOST>".*"status":40[13].*$
            ^.*"remote_addr":"<HOST>.*"status":40[13].*$

# Ignore successful requests
ignoreregex = ^.*"status":200.*$
              ^.*"status":30[0-9].*$
