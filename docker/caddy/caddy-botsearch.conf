# Fail2ban filter for Caddy bot/scanner detection
# This file should be placed in /docker/appdata/fail2ban-caddy/data/filter.d/caddy-botsearch.conf

[Definition]

# Matches common bot/scanner patterns in Caddy JSON logs
failregex = ^.*"remote_ip":"<HOST>".*"uri":".*(/\.env|/wp-admin|/admin|/phpmyadmin|/\.git|/config|/backup|/sql).*$
            ^.*"remote_ip":"<HOST>".*"user_agent":".*[Bb]ot.*$
            ^.*"remote_ip":"<HOST>".*"user_agent":".*[Ss]canner.*$
            ^.*"remote_ip":"<HOST>".*"user_agent":".*[Cc]rawler.*$
            ^.*"remote_ip":"<HOST>".*"status":404.*"uri":".*\.(php|asp|jsp).*$

# Ignore legitimate requests
ignoreregex = ^.*"user_agent":".*Mozilla.*$
              ^.*"status":200.*$
